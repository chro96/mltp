<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="shortcut icon" href="../../../img/favicon.ico">
  <title>Linear Regression - Machine Learning engineer Training Program</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../../../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="../../../css/highlight.css">
  
  <script>
    // Current page data
    var mkdocs_page_name = "Linear Regression";
    var mkdocs_page_input_path = "section1/unit5/linear_regression.md";
    var mkdocs_page_url = "/section1/unit5/linear_regression/";
  </script>
  
  <script src="../../../js/jquery-2.1.1.min.js"></script>
  <script src="../../../js/modernizr-2.8.3.min.js"></script>
  <script type="text/javascript" src="../../../js/highlight.pack.js"></script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href="../../.." class="icon icon-home"> Machine Learning engineer Training Program</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
	  
          
            <li class="toctree-l1">
		
    <a class="" href="../../..">Home</a>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Traditional Machine Learning</span>
    <ul class="subnav">
                <li class="">
                    
    <span class="caption-text">Unit1</span>
    <ul class="subnav">
                <li class="toctree-l3">
                    
    <a class="" href="../../unit1/introduction/">Introduction</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../unit1/k-nn/">k-Nearest Neighbors</a>
                </li>
    </ul>
                </li>
                <li class="">
                    
    <span class="caption-text">Unit2</span>
    <ul class="subnav">
                <li class="toctree-l3">
                    
    <a class="" href="../../unit2/supervised_learning/">Supervised Learning</a>
                </li>
    </ul>
                </li>
                <li class="">
                    
    <span class="caption-text">Unit3</span>
    <ul class="subnav">
                <li class="toctree-l3">
                    
    <a class="" href="../../unit3/naive_bayes/">Naive Bayes</a>
                </li>
    </ul>
                </li>
                <li class="">
                    
    <span class="caption-text">Unit4</span>
    <ul class="subnav">
                <li class="toctree-l3">
                    
    <a class="" href="../../unit4/k-means/">K-Means Clustering</a>
                </li>
    </ul>
                </li>
                <li class=" current">
                    
    <span class="caption-text">Unit5</span>
    <ul class="subnav">
                <li class="toctree-l3 current">
                    
    <a class="current" href="./">Linear Regression</a>
    <ul class="subnav">
            
    <li class="toctree-l4"><a href="#linear-regression">Linear Regressionの説明</a></li>
    

    <li class="toctree-l4"><a href="#exercises">Exercises</a></li>
    
        <ul>
        
            <li><a class="toctree-l5" href="#exercise-1">Exercise 1</a></li>
        
            <li><a class="toctree-l5" href="#exercise-2">Exercise 2</a></li>
        
            <li><a class="toctree-l5" href="#exercise-3">Exercise 3</a></li>
        
            <li><a class="toctree-l5" href="#exercise-4">Exercise 4</a></li>
        
        </ul>
    

    <li class="toctree-l4"><a href="#diabetes-dataset">Diabetes Dataset</a></li>
    

    </ul>
                </li>
    </ul>
                </li>
                <li class="">
                    
    <span class="caption-text">Unit6</span>
    <ul class="subnav">
                <li class="toctree-l3">
                    
    <a class="" href="../../unit6/logistic_regression/">Logistic Regression</a>
                </li>
    </ul>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Deep Learning</span>
    <ul class="subnav">
                <li class="">
                    
    <span class="caption-text">Unit7</span>
    <ul class="subnav">
                <li class="toctree-l3">
                    
    <a class="" href="../../../section2/unit7/logistic_regression2/">Logistic Regression2</a>
                </li>
    </ul>
                </li>
    </ul>
	    </li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../..">Machine Learning engineer Training Program</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../..">Docs</a> &raquo;</li>
    
      
        
          <li>Traditional Machine Learning &raquo;</li>
        
      
        
          <li>Unit5 &raquo;</li>
        
      
    
    <li>Linear Regression</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <p>Linear RegressionはSupervised Learningですが、k-NNやNaive Bayesがクラスを予測するClassificationなのに対し、Linear Regressionは数値を予測するRegressionになります。不動産の価格予測や株式市場の予測がRegressionに当たります。</p>
<p>Linear RegressionではOptimization(最適化)を使うので、アルゴリズムの種類としてはLogistic RegressionやNeural Networkと同じです。Deep Learningを学ぶ上での土台となる理論が詰まっています。</p>
<p>Optimizationには微分積分を使うので今までより急激に難しくなります。</p>
<h1 id="linear-regression">Linear Regressionの説明</h1>
<p><a href="http://cs229.stanford.edu/materials.html">Andrew NgのLecture notes1</a>が非常に分かり易いので、それを元に説明します。</p>
<p>Linear Regressionは線形関数を使ってインプット(x)からアウトプット(y)を概算します。例えば不動産の価格予測であればインプットが専有面積や間取り、アウトプットが価格となります。</p>
<p>以下の簡単なデータを使って説明していきます。xの特徴は幾つあっても良いのですが、グラフで説明するためこのデータのxの特徴は一つだけです。</p>
<table>
<thead>
<tr>
<th>x</th>
<th>y</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>-1</td>
</tr>
<tr>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>2</td>
<td>3</td>
</tr>
<tr>
<td>3</td>
<td>5</td>
</tr>
</tbody>
</table>
<p><img alt="plot1" src="../../../img/unit5/plot1.png" /></p>
<p>yを概算する線形関数を求めろと人間が言われたら直感的に分かると思います。</p>
<p><img alt="plot2" src="../../../img/unit5/plot2.png" /></p>
<p>このようにグラフにすると全てのデータが直線状に並んでいます。普通のデータこんなにクリーンではないですが、説明し易いので簡単なデータを選びました。</p>
<p>計算すると分かる通り、この線形関数は</p>
<p>
<script type="math/tex; mode=display"> y = 2x - 1 </script>
</p>
<p>です。</p>
<p>これを数式にすると以下のようになります。<script type="math/tex">y</script>と<script type="math/tex">h(x)</script>は同じ意味です。<script type="math/tex">n</script>は特徴の数です。</p>
<p>
<script type="math/tex; mode=display"> h(x) = \theta_0 + \theta_1x_1 + \theta_2x_2 + \dots + \theta_nx_n </script>
</p>
<p>今回の例ではxの特徴が一つしかないので以下のようになります。</p>
<p>
<script type="math/tex; mode=display"> h(x) = \theta_0 + \theta_1x_1 </script>
</p>
<p>
<script type="math/tex">\theta_0 = -1</script>, <script type="math/tex">\theta_1 = 2</script>です。</p>
<p>この数式はdot productで表せるのですが、その為には<script type="math/tex">\theta</script>と<script type="math/tex">x</script>を同じ長さにする必要があります。<script type="math/tex">\theta_0</script>はインターセプトなので、<script type="math/tex">x_0 = 1</script>にします。</p>
<p>
<script type="math/tex; mode=display">
\begin{align}
h(x) & = \theta_0x_0 + \theta_1x_1 + \theta_2x_2 + \dots + \theta_nx_n \\
          &=  \displaystyle\sum_{i=0}^{n} \theta_ix_i  \\
           &= \theta^Tx
\end{align}
</script>
</p>
<p>
<script type="math/tex">x_1 = 3</script>を計算してみましょう。</p>
<p>
<script type="math/tex; mode=display">
\begin{align}
h(x) &=  \theta^Tx \\
&= 
\begin{bmatrix}
-1 & 2
\end{bmatrix}
\cdot
\begin{bmatrix}
1 \\ 3
\end{bmatrix} \\
&= -1 \cdot 1 + 2 \cdot 3 \\
&= 5
\end{align}
</script>
</p>
<p>xは１サンプルですが、全サンプル(X)を一度に計算した方が楽なので、以下の数式を使います。mをサンプル数とするとXが<script type="math/tex">m \times n</script>, <script type="math/tex">\theta</script>が<script type="math/tex">n \times 1</script>なので<script type="math/tex">h(X)</script>が<script type="math/tex">m \times 1</script>となります。</p>
<p>
<script type="math/tex; mode=display"> h(X) = X\theta </script>
</p>
<p>例のデータを一度に計算してみましょう。</p>
<p>
<script type="math/tex; mode=display"> 
\begin{align} h(X) &= X\theta \\ 
&= \begin{bmatrix}
1 & 0 \\
1 & 1 \\
1 & 2 \\
1 & 3 \\
\end{bmatrix} 
\cdot 
\begin{bmatrix}-1 \\ 2
\end{bmatrix} \\ 
&= 
\begin{bmatrix}
-1 \\ 1 \\ 3 \\ 5
\end{bmatrix}
\end{align}
</script>
</p>
<p>上記は最適な<script type="math/tex">\theta</script>を使って計算したものですが、目的はこの<script type="math/tex">\theta</script>を見つけることです。その為にはまず<script type="math/tex">\theta</script>を適当に選び、<script type="math/tex">h(x)</script>が<script type="math/tex">y</script>とどれだけ違うかに応じて<script type="math/tex">\theta</script>を修正していきます。</p>
<p><a href="http://cs229.stanford.edu/materials.html">Andrew NgのLecture notes1の4ページ</a>に最適化の説明が書かれています。微分積分が関わる部分なのでここでの説明は割愛します。<script type="math/tex">\theta</script>をアップデートする数式は以下の通りです。</p>
<p>
<script type="math/tex; mode=display"> \theta := \theta + \frac{\alpha}{m} (y - h(x))X </script>
</p>
<p>
<script type="math/tex">\alpha</script>は<em>learning rate</em>と呼ばれるもので、どれだけ早く最適化するかを設定します。これが小さすぎると学習が遅く、大きすぎるとconverge(収束)しなくなります。コードを書いて実際にアルゴリズムを実行すると理解出来ると思います。</p>
<p>mで割る理由は、サンプル数によるエラー値の違いを無くすためです。mがないとサンプル数に応じて<script type="math/tex">\alpha</script>を微調整することになり大変です。</p>
<h1 id="exercises">Exercises</h1>
<p>ではコードを書いていきましょう。
<code>eta</code>はlearning rateのことです。<code>fit</code>ではまず<script type="math/tex">x_0</script>を足します。</p>
<pre><code class="python">class MyLinearRegression(object):
    def __init__(self, eta=0.1, n_iter=50):
        self.eta = eta
        self.n_iter = n_iter

    def fit(self, X, y):
        X = np.insert(X, 0, 1, axis=1)
        return X

X = np.array([[0], [1], [2], [3]])
y = np.array([-1, 1, 3, 5])
regr = MyLinearRegression()
print(regr.fit(X, y))
</code></pre>

<pre><code class="Output">[[1 0]
 [1 1]
 [1 2]
 [1 3]]
</code></pre>

<h2 id="exercise-1">Exercise 1</h2>
<p>
<script type="math/tex">h(X) = X\theta</script>を計算しましょう。</p>
<h2 id="exercise-2">Exercise 2</h2>
<p>
<script type="math/tex">\theta := \theta + \frac{\alpha}{m} (y - h(x))X</script>を計算しましょう。<code>m</code>と<code>self.eta</code>を使って下さい。</p>
<h2 id="exercise-3">Exercise 3</h2>
<p><code>predict</code>を書きましょう。Exercise1とほとんど同じです。</p>
<h2 id="exercise-4">Exercise 4</h2>
<p>Linear Regressionは完成したんですが、一つ問題があります。サンプル数が多いと計算するのに時間がかかり学習が遅いです。<em>Stochastic Gradient Descent</em>(SGD)はこれを解決する為に１サンプルづつ計算しその都度weightをアップデートします。SGDの欠点はエラーの最小値にconvergeにしないことですが、実際はそこまで大きな問題ではありません。</p>
<p>weightをアップデートするコードを書きましょう。１サンプルづつなのでmはもう必要ありません。</p>
<h1 id="diabetes-dataset">Diabetes Dataset</h1>
<p><a href="http://scikit-learn.org/stable/modules/generated/sklearn.datasets.load_diabetes.html">Diabetes Dataset</a>を使ってみました。特徴が１０個ありますが、視覚化したいので１つだけ使うことにしました。是非色んな特徴で試してみて下さい。</p>
<p><img alt="diabetes" src="../../../img/unit5/diabetes.png" /></p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../../unit6/logistic_regression/" class="btn btn-neutral float-right" title="Logistic Regression">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../../unit4/k-means/" class="btn btn-neutral" title="K-Means Clustering"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
	  
        </div>
      </div>

    </section>
    
  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="../../unit4/k-means/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../../unit6/logistic_regression/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script src="../../../js/theme.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

</body>
</html>
